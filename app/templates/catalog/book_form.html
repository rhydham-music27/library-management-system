{% extends 'base.html' %}
{% block title %}{{ title }} - Library Management System{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="{{ url_for('main.index') }}">Home</a></li>
    <li class="breadcrumb-item"><a href="{{ url_for('catalog.books') }}">Books</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ title }}</li>
  </ol>
</nav>

<div class="card mx-auto" style="max-width: 900px;">
  <div class="card-header fw-semibold"><i class="bi bi-journal-plus me-2"></i>{{ title }}</div>
  <div class="card-body">
    <form method="post" novalidate>
      {{ form.hidden_tag() }}
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label">ISBN</label>
          {{ form.isbn(class='form-control', placeholder='Optional, 13-digit ISBN') }}
          {% for e in form.isbn.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Title <span class="text-danger">*</span></label>
          {{ form.title(class='form-control', required=true) }}
          {% for e in form.title.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Author <span class="text-danger">*</span></label>
          {{ form.author(class='form-control', required=true) }}
          {% for e in form.author.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Publisher</label>
          {{ form.publisher(class='form-control') }}
          {% for e in form.publisher.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-4">
          <label class="form-label">Publication Year</label>
          {{ form.publication_year(class='form-control') }}
          {% for e in form.publication_year.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-4">
          <label class="form-label">Edition</label>
          {{ form.edition(class='form-control') }}
          {% for e in form.edition.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-4">
          <label class="form-label">Language</label>
          {{ form.language(class='form-control', value=form.language.data or 'English') }}
          {% for e in form.language.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Pages</label>
          {{ form.pages(class='form-control') }}
          {% for e in form.pages.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Category</label>
          {{ form.category_id(class='form-select') }}
          {% for e in form.category_id.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Quantity <span class="text-danger">*</span></label>
          {{ form.quantity(class='form-control', min=1) }}
          <div class="form-text">Total copies in library</div>
          {% for e in form.quantity.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-md-6">
          <label class="form-label">Shelf Location</label>
          {{ form.shelf_location(class='form-control', placeholder='e.g., A-12') }}
          {% for e in form.shelf_location.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
        <div class="col-12">
          <label class="form-label">Description</label>
          {{ form.description(class='form-control', rows=4) }}
          {% for e in form.description.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
        </div>
      </div>
      <div class="mt-3 d-flex gap-2">
        {{ form.submit(class='btn btn-primary') }}
        {% if title == 'Edit Book' and book %}
          <a href="{{ url_for('catalog.book_detail', book_id=book.id) }}" class="btn btn-secondary">Cancel</a>
        {% else %}
          <a href="{{ url_for('catalog.books') }}" class="btn btn-secondary">Cancel</a>
        {% endif %}
      </div>
    </form>
  </div>
</div>
{% endblock %}
